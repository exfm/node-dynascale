#!/usr/bin/env node
"use strict";

var when = require('when'),
	sequence = require('sequence'),
	plata = require('plata'),
	AWS = require('aws-sdk'),
	dynamo,
	getConfig = require('junto'),
	nconf = require('nconf');

var config;

nconf.file({'file': 'config.json'});

getConfig('development').then(function(c){
	config = c;
	plata.connect(config.aws);
	AWS.config.update({accessKeyId: config.aws.key, secretAccessKey: config.aws.secret});
	AWS.config.update({region: 'us-east-1'});
});

plata.onConnected(function(){

	dynamo = new AWS.DynamoDB();

	dynamo.client.describeTable({
		'TableName': 'Petrucci'
	}).always(function (resp) {
		console.log(resp.data, resp.error);
	});

	// var timeRangeMinutes = 30,
	// 	startTime = new Date(new Date().getTime() - 1000*60*timeRangeMinutes),
	// 	endTime = new Date(),
	// 	statistics = {
	// 		'Average': '1'
	// 	};

	// plata.cloudWatch.getMetricStatistics('AWS/DynamoDB', 'ConsumedReadCapacityUnits',
	// 	'60', startTime.toISOString(), endTime.toISOString(),
	// 	statistics, 'Count', {
	// 			'TableName': 'Petrucci'
	// 		}).then(function(data){
	// 			console.log(data);
	// 		});
});